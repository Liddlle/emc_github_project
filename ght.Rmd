
```{bash}
#ssh -L -i ~/.ssh/id_rsa 33306:web.ghtorrent.org:3306 ghtorrent@web.ghtorrent.org
#ps axuf | grep ssh
#mysql -u ght -h 127.0.0.1 -P 33306 ghtorrent
```


```{r}
library("knitr")
library("ggplot2")
library(readr)
library("reshape")
if (! "RMySQL" %in% installed.packages()) install.packages("RMySQL")
if (! "sqldf" %in% installed.packages()) install.packages("sqldf")
if (! "optparse" %in% installed.packages()) install.packages("optparse")
if (! "foreach" %in% installed.packages()) install.packages("foreach")
if (! "doMC" %in% installed.packages()) install.packages("doMC")

require(devtools)

```

* Создать базу с топ-50 организаций + их проекты и участники 
* Посмотреть библиотеки для  больших данных в р 
* Длина обработки реквестов и "важность" или вовлеченность участника 
* Подумать как можно выделять основных участников (core) проекта

```{r}
source(file = "R/packages.R")
library(optparse)
library(knitr)
#rm(list = ls(all = TRUE))

mysql.user   =  "ght"
mysql.passwd = ""
mysql.db     = "ghtorrent"
mysql.host   = "127.0.0.1"
mysql.port = 33306
paralll      = 4

library(RMySQL)

ghtor = dbConnect(dbDriver("MySQL"),
          user = mysql.user,
          password = mysql.passwd,
          dbname = mysql.db,
          host = mysql.host,
          port = mysql.port)
#dbClearResult(dbListResults(ghtor)[[1]])
dbListFields(ghtor,"followers")
dbListTables(ghtor)

dbGetQuery(ghtor, "top 10 select * from followers limit 5")

x = dbGetQuery(ghtor, "select org_id, COUNT(*) as total_m from organization_members group by org_id order by total_m DESC limit 50") #топ 50 организаций по кол-ву участников 
#select id, login from users where id = '95143' 

top_orgs = paste(c(x[1:20,1]), collapse = "','")
top_orgs = paste0(c('select * from organization_members where org_id in ', "('", top_orgs, "')"), collapse = "")

org_mem = dbGetQuery(ghtor, top_orgs) 



#write_csv(x, "~/emc_github_project/top_organizations.csv")
#write_csv(org_mem3, "~/emc_github_project/members.csv")

```

